<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice-Enabled Chatbot</title>
    <link rel="stylesheet" href="/static/styles.css"> <!-- Correct path for styles -->
</head>
<body>
    <h1>Chat with the Bot</h1>
    <div id="chat-history"></div>
    <button id="start-record-btn">Start Recording</button>
    <button id="stop-record-btn" disabled>Stop Recording</button>
    <p id="status"></p>
    <div id="chat-response"></div>

    <form id="chat-form">
        <input type="text" id="chat-input" placeholder="Enter your message">
        <button type="submit">Send</button>
    </form>

    <script src="/static/app.js"></script> <!-- Correct path for app.js -->
    <script>
        const API_URL = '/chat'; // Relative path for the backend API

        const startRecordBtn = document.getElementById('start-record-btn');
        const stopRecordBtn = document.getElementById('stop-record-btn');
        const status = document.getElementById('status');
        const chatResponse = document.getElementById('chat-response');
        const chatHistory = document.getElementById('chat-history');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');

        let recognition;

        if ('webkitSpeechRecognition' in window) {
            recognition = new webkitSpeechRecognition();
        } else if ('SpeechRecognition' in window) {
            recognition = new SpeechRecognition();
        } else {
            alert('Your browser does not support speech recognition.');
        }

        if (recognition) {
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            recognition.onstart = () => {
                status.textContent = 'Listening...';
                startRecordBtn.disabled = true;
                stopRecordBtn.disabled = false;
            };

            recognition.onresult = async (event) => {
                const transcript = event.results[0][0].transcript;
                status.textContent = `You said: ${transcript}`;
                await sendMessage(transcript);
            };

            recognition.onerror = (event) => {
                status.textContent = `Error occurred: ${event.error}`;
            };

            recognition.onend = () => {
                startRecordBtn.disabled = false;
                stopRecordBtn.disabled = true;
            };

            startRecordBtn.addEventListener('click', () => {
                recognition.start();
            });

            stopRecordBtn.addEventListener('click', () => {
                recognition.stop();
            });

            chatForm.addEventListener('submit', async (event) => {
                event.preventDefault();
                const message = chatInput.value.trim();
                if (message) {
                    await sendMessage(message);
                    chatInput.value = '';
                } else {
                    chatResponse.textContent = "Please enter a message.";
                }
            });
        }

        async function sendMessage(message) {
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message })
                });
                const data = await response.json();

                if (data.response) {
                    chatResponse.textContent = `Chat
7
